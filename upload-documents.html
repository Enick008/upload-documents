<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£ ‡∏Å‡∏≠‡∏á‡∏ä‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏Ç‡∏≤‡∏†‡∏¥‡∏ö‡∏≤‡∏•</title>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    body {
      font-family: 'Prompt', sans-serif;
      background-color: #f0f8ff;
      margin: 0;
    }
    header {
      background-color: #ffffff;
      text-align: center;
      padding: 20px;
    }
    header img {
      height: 100px;
      width: auto;
    }
    nav {
      display: flex;
      justify-content: center;
      background-color: #e0f0ff;
    }
    nav button {
      padding: 10px 20px;
      border: none;
      background: none;
      cursor: pointer;
      font-size: 16px;
    }
    nav button.active {
      border-bottom: 2px solid #007aff;
      font-weight: bold;
    }
    section {
      padding: 20px;
      display: none;
    }
    section.active {
      display: block;
    }
    footer {
      background-color: #f0f8ff;
      text-align: center;
      padding: 10px;
      color: #666;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 10px;
    }
    th, td {
      border: 1px solid #ccc;
      padding: 8px;
    }
    th {
      background-color: #e6f2ff;
    }
  </style>
</head>
<body>
  <header>
    <img src="https://upload.wikimedia.org/wikipedia/commons/b/b1/Seal_of_Ko_Samui.png" alt="‡πÇ‡∏•‡πÇ‡∏Å‡πâ‡πÄ‡∏ó‡∏®‡∏ö‡∏≤‡∏•">
  </header>

  <nav>
    <button class="tab-button active" data-tab="list">üìÑ ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</button>
    <button class="tab-button" data-tab="upload">üì§ ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</button>
  </nav>

  <section id="list" class="active">
    <h2>‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h2>
    <div id="docList">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î...</div>
  </section>

  <section id="upload">
    <h2>‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</h2>
    <form id="uploadForm">
      <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ù‡πà‡∏≤‡∏¢:</label>
      <select name="department" required>
        <option value="">-- ‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏ù‡πà‡∏≤‡∏¢ --</option>
        <option value="‡∏á‡∏≤‡∏ô‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡∏¢‡∏∞">‡∏á‡∏≤‡∏ô‡∏à‡∏±‡∏î‡πÄ‡∏Å‡πá‡∏ö‡∏Ç‡∏¢‡∏∞</option>
        <option value="‡∏á‡∏≤‡∏ô‡∏î‡∏π‡∏î‡∏™‡∏¥‡πà‡∏á‡∏õ‡∏è‡∏¥‡∏Å‡∏π‡∏•">‡∏á‡∏≤‡∏ô‡∏î‡∏π‡∏î‡∏™‡∏¥‡πà‡∏á‡∏õ‡∏è‡∏¥‡∏Å‡∏π‡∏•</option>
        <option value="‡∏á‡∏≤‡∏ô‡∏™‡∏∏‡∏Ç‡∏≤‡∏†‡∏¥‡∏ö‡∏≤‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ">‡∏á‡∏≤‡∏ô‡∏™‡∏∏‡∏Ç‡∏≤‡∏†‡∏¥‡∏ö‡∏≤‡∏•‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</option>
      </select>
      <br><br>
      <label>‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£:</label>
      <input type="file" name="file" required>
      <br><br>
      <button type="submit">üì§ ‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î</button>
    </form>
  </section>

  <footer>
    ¬©2025 ‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏±‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏ù‡∏≤‡∏ó‡πà‡∏≠‡∏£‡∏∞‡∏ö‡∏≤‡∏¢‡∏ô‡πâ‡∏≥‡∏ä‡∏≥‡∏£‡∏∏‡∏î ‡∏Å‡∏≠‡∏á‡∏ä‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏Ç‡∏≤‡∏†‡∏¥‡∏ö‡∏≤‡∏• ‡πÇ‡∏î‡∏¢ ‡∏ô‡∏≤‡∏¢‡∏ò‡∏µ‡∏£‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå ‡∏û‡∏π‡∏•‡πÄ‡∏Ç‡∏≤‡∏•‡πâ‡∏≤‡∏ô
  </footer>

  <script>
    const tabButtons = document.querySelectorAll('.tab-button');
    const sections = document.querySelectorAll('section');

    tabButtons.forEach(btn => {
      btn.addEventListener('click', () => {
        tabButtons.forEach(b => b.classList.remove('active'));
        sections.forEach(s => s.classList.remove('active'));
        btn.classList.add('active');
        document.getElementById(btn.dataset.tab).classList.add('active');
        if (btn.dataset.tab === 'list') loadDocuments();
      });
    });

    document.getElementById('uploadForm').addEventListener('submit', async function (e) {
      e.preventDefault();
      const form = e.target;
      const file = form.file.files[0];
      const department = form.department.value;

      if (!file || !department) return;

      const formData = new FormData();
      formData.append('file', file);
      formData.append('department', department);

      Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î...', allowOutsideClick: false, didOpen: () => Swal.showLoading() });

      const res = await fetch('https://script.google.com/macros/s/AKfycbzYwE32ez5TBL8ONjhzm_1vZqa-UkREO1NXQ74X7dBjPyOhURd6lWY4TBlYciooSQykhw/exec', {
        method: 'POST',
        body: formData
      });

      const result = await res.json();
      Swal.close();

      if (result.success) {
        Swal.fire('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à', '‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß', 'success');
        form.reset();
        loadDocuments();
      } else {
        Swal.fire('‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', result.error || '‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡∏≠‡∏±‡∏û‡πÇ‡∏´‡∏•‡∏î', 'error');
      }
    });

    async function loadDocuments() {
      const res = await fetch('https://script.google.com/macros/s/AKfycbzYwE32ez5TBL8ONjhzm_1vZqa-UkREO1NXQ74X7dBjPyOhURd6lWY4TBlYciooSQykhw/exec');
      const data = await res.json();
      const container = document.getElementById('docList');
      if (!data.success) return container.innerHTML = '‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÑ‡∏î‡πâ';

      const grouped = {};
      data.documents.forEach(doc => {
        grouped[doc.department] = grouped[doc.department] || [];
        grouped[doc.department].push(doc);
      });

      container.innerHTML = '';
      for (let dept in grouped) {
        container.innerHTML += `<h3>${dept}</h3><table><tr><th>‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏≠‡∏Å‡∏™‡∏≤‡∏£</th><th>‡∏•‡∏¥‡∏á‡∏Å‡πå</th></tr>` +
          grouped[dept].map(d => `<tr><td>${d.name}</td><td><a href="${d.url}" target="_blank">‡πÄ‡∏õ‡∏¥‡∏î</a></td></tr>`).join('') + `</table>`;
      }
    }

    loadDocuments();
  </script>
</body>
</html>
